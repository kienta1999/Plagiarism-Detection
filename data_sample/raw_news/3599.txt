“Love, Simon” knows its way to a teenager’s heart: through a high school musical theater production.

As a gay coming-of-age story made by a top-tier Hollywood studio, Greg Berlanti’s endearing movie, which opened in theaters last weekend, is a rarity. “Love, Simon” lets its titular protagonist (Nick Robinson) find romance via tropes that define the John Hughesian rom-coms fashionable in the 1980s and ’90s ― a genre long limited to heterosexual characters. Among many queer selling points is Simon and his classmates’ deliciously disastrous rendition of “Cabaret,” rife with the subpar vocal talent, ditzy choreography and infinite passion seen in many an adolescent theater spectacle.

Just as Saoirse Ronan and Lucas Hedges schlepped through “Merrily We Roll Along” in last year’s “Lady Bird,” Robinson, Alexandra Shipp, Logan Miller and other young actors of “Love, Simon” welcome us to “Cabaret” with all of their characters’ amateurish might. It’s only fitting that their exhausted theater teacher, played by “Insecure” scene-stealer Natasha Rothwell, has to remind them that the musical’s setting ― 1931 Germany ― wasn’t as affable a place as their school auditorium. “You’re Nazis! More anger,” she barks in a line Rothwell improvised, breaking up two cast members caught smooching during rehearsal.

In "Love, Simon," drama club kids are coached by Natasha Rothwell of "Insecure." Fox

The headiness of “Cabaret” makes it the perfect choice for a high school staging, largely because the kids underestimate just how much they don’t understand about their wonky rendering. But, like the Becky Albertalli novel on which it’s based, “Love, Simon” initially had another musical at its center: “Oliver!,” the Dickensian classic about a British orphan who runs away and befriends a gang of pickpockets.

Berlanti couldn’t land the rights to “Oliver!,” so his next idea was to concoct an original show based on the John Cusack movie “Say Anything...,” one of those Hughesian rom-coms that “Love, Simon” evokes. After “Oliver!” fell through, the screenwriters ― “This Is Us” scribes Elizabeth Berger and Isaac Aptaker ― wrote a couple of Cusack-inspired bits.

“The idea was that the drama teacher had penned this musical herself over many years ― ‘Say Anything...’ fan fiction, basically — and putting it up onstage with a bunch of high schoolers was the culmination of her life’s work,” Berger and Aptaker told HuffPost. “There was gonna be a big ‘In Your Eyes’ musical number with a bunch of backup dancers holding up the boomboxes and everything. Eventually, it felt like it was taking up too much screen time and was too big of a notion for the movie to bear, so we decided to go in a different, simpler direction.”

The scaffolding seen in the movie came from a high school production of "Grease." Courtesy of Aaron Osborne

Berlanti felt the “Say Anything...” concept was “too meta,” so he thought back to his own college production of “Cabaret.” The play’s narrative about sexual identity provided a convenient parallel with “Love, Simon,” in which Simon gradually accepts his own sexuality while exchanging anonymous emails with a closeted classmate. Securing the rights to “Cabaret” was a cinch, according to Berlanti. There was only one precept: He couldn’t use imagery unique to the 1972 movie, including the famous top hat Liza Minnelli wore as Sally Bowles.

From there, Berlanti and production designer Aaron Osborne scouted out schools whose auditoriums would provide ample backstage space, where the prototypical theater kid could make himself at home and develop an innocent crush or two. Landing on an Atlanta campus, Osborne borrowed a scaffolding platform the school had already constructed for a production of “Grease.” He built a model of the stage, hanging illuminated red “CABARET” letters in the center ― though Osborne and Berlanti debated whether the sign should instead say “Kit Kat Club,” the seedy nightclub where much of the action takes place. They decided that reference was too obscure for anyone unfamiliar with John Kander, Fred Ebb and Joe Masteroff’s work.

Throughout the rehearsal scenes seen in “Love, Simon,” Rothwell establishes herself as a mama lion who has gone from experienced theater actress to directing youngsters with little hope of stage careers. At first, she’s optimistic, saying, “When we get done, it’s gonna look like a real German sex club. Don’t ask me how I know.” But her hope for an exemplary play is dashed by the end: “I was an extra in ‘The Lion King,’ and this is where I am? They don’t pay me enough for this crap.” Rothwell’s brassy reactions and jaded quips earn the movie’s biggest laughs. In fact, Berlanti captured so many golden moments from Rothwell that he says he could make a “half-hour comedy” from the material left on the cutting-room floor.

As for that German sex club, the 3D letters suspended from the ceiling on Osborne’s model fell one day, inspiring a gag that made its way into the movie: During the big opening-night performance, the “Cabaret” sign comes crashing down, nearly hitting a student in the head and capping off a comically disastrous venture with electrical sparks that were added in post-production.

To get to the scene with the descending sign, Berlanti worked with choreographer Zach Woodlee, his former collaborator on the ABC legal dramedy “Eli Stone” and the Katherine Heigl movie “Life as We Know It.” They staged the kind of imperfect dance routines familiar to any high school troupe. Shepherding teen ensembles ― or, rather, adults portraying teens ― was familiar territory for Woodlee, who choreographed five seasons of “Glee.” One crucial difference: The numbers on “Glee” were meant to look polished, whereas this needed to be scrappy and unrefined.

Even the music Woodlee was working with had a crude feel. A “Love, Simon” producer commissioned a pre-recorded soundtrack featuring first-rate singers, but Berlanti thought it sounded too professional. Instead, he had the cast record individual voice tracks, no matter their aptitude, which is what we now hear the students singing in the movie. Robinson only agreed to participate if Berlanti sang alongside him, so Berlanti counts “Love, Simon” as the first time he has appeared in a project he helmed. (Berlanti previously wrote and directed the lovely gay friendship dramedy “The Broken Hearts Club,” and he has written for numerous TV series including “Dawson’s Creek,” “Everwood,” “The Flash” and “Supergirl.”)

A “Love, Simon” producer commissioned a pre-recorded soundtrack featuring first-rate singers, but Berlanti thought it sounded too professional. Fox

Woodlee spent only a day rehearsing the cast’s opening-night dance scene ― the one with the tumbling sign.

“With the choreography cues, there were different times when, with singing or dancing, they would mess up and say, ‘Oh, I want to try it again,’ and I would be like, ‘Oh no, that’s perfect,’” Berlanti said, again emphasizing that glitches were paramount.

Still, by premiere time, we’re meant to glean that most of the hiccups are out of the way, even if that sign threatens to take a few dancers down with it.

“High school productions are the one thing that can be inherently campy,” Berlanti said. “They can be gloriously bad and gloriously wonderful, all at the same time. I think that’s the true magic behind how we choreographed it and talked about it. You’re showing how awful it can be, but at the same time their exuberance is more pure than any performers in the world because they love that they’re getting to do this.”
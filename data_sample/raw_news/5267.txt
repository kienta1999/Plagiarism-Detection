Nikolas Cruz faces 17 charges of premeditated murder in the massacre at Marjory Stoneman Douglas High School. Before the shooting, he exhibited dozens of warning signs, but was able to legally purchase firearms. POOL New / Reuters

Despite this, Cruz, 19, was able to legally acquire an arsenal of firearms, including the AR-15 police say he used to slaughter 17 people last week at his former high school in Parkland, Florida.

Without a criminal record or a court declaring him mentally incompetent, Cruz was free to arm himself as heavily as he could afford in his home state.

This would not have been the case in the five states that allow law enforcement or family members to petition a court to temporarily remove guns from individuals who pose a threat to themselves or others.

The policy, alternately called a “red flag” law, “gun violence restraining order,” or “extreme risk protection order,” is getting more attention since the mass shooting at Marjory Stoneman Douglas High School.

Federal law prohibits some individuals from buying or owning guns: those who have been convicted of a felony or a domestic violence misdemeanor, are an undocumented immigrant or fugitive from justice, were dishonorably discharged from the military, or have been involuntarily committed to a mental institution.

Some states have gone further, passing laws to prevent individuals who are exhibiting red flags, but haven’t yet committed a crime, from possessing firearms, explained Robin Lloyd, the director of government affairs at Giffords, the gun violence prevention organization established by the former congresswoman and shooting survivor Gabrielle Giffords.

California, Washington, Oregon, Indiana and Connecticut have approved measures that allow a court to temporarily strip gun rights from people who show warning signs of violence.

While each state differs, here’s broadly how they work: A concerned family member or police officer asks a judge to remove guns from an individual they believe is at risk of hurting themselves or others.

A temporary order, which typically lasts for a few weeks, can be issued immediately if there’s evidence it’s needed to prevent imminent danger.

Individuals are given notice of a final hearing, where a judge will decide if they should be prohibited from gun possession for a longer period of time, generally a year. They may contest the evidence against them, and can appeal the decision.

In Cruz’s case, “it’s entirely possible that there could have been an intervention beforehand to remove firearms” if Florida had a red flag law, said Lloyd, noting that police responded to his family home on dozens of occasions. “We know this is a life-saving measure.”

California was the first state to allow family members to petition a court to remove guns from individuals who exhibit alarming warning signs.

The legislation was passed in 2014, a few months after the Isla Vista rampage, in which Elliot Rodger killed six people and injured 13. A month before the massacre, his mother contacted mental health officials, saying she was worried about disturbing videos he was posting to YouTube. Law enforcement performed a welfare check, but said their hands were tied. There was nothing legally preventing him from possessing a gun.

Similar legislation has been proposed in 18 other states this year. Elizabeth Avore, legal and policy director for Everytown for Gun Safety, said passing red flag laws was a top priority for her organization, even before the Florida mass shooting.

“We see over and over again that these mass shooters have demonstrated warning signs prior to the act of violence,” Avore said. “After the Florida school shooting, there is renewed interest ― and bipartisan interest ― in these laws.”

Florida state Rep. Lori Berman (D) introduced a red flag bill last year, and told HuffPost it received no bipartisan support at the time. Now, it seems like her bill may pick up steam. Prominent Florida Republicans, such as former presidential candidates Marco Rubio and Jeb Bush, have come out in support of the approach.

“We haven’t had a serious discussion about gun safety in the state of Florida,” Berman said, noting that she has introduced at least seven bills on gun violence prevention during her time in the legislature. None has ever even received a hearing.

“It saddens me that it took this event to have this discussion,” Berman said.

Rep. Salud Carbajal (D-Calif.) introduced federal legislation last year that would encourage states to adopt red flag laws with grant money. Carbajal said the approach is “sensible and reasonable,” and may have prevented Cruz from committing a mass shooting.
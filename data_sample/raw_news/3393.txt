WASHINGTON (Reuters) - The U.S. Congress voted early on Friday to approve a $1.3-trillion government funding bill with large increases in military and non-defense spending, sending it to President Donald Trump, who was expected to sign it into law.

With Trump’s signature, the bill will avert a threatened government shutdown and keep federal agencies funded until Sept. 30, ending for now Washington’s constant budget squabbles and letting lawmakers focus on getting reelected in November.

The Senate voted 65-32 for the bill, several hours after the House of Representatives passed it 256-167 on Thursday.

The votes capped a long struggle by Congress, which was supposed to have approved the government funding by last Oct. 1.

Since then, several stop-gap spending bills have kept the government open, except for two brief shutdowns earlier this year when Congress deadlocked and funding expired.

Despite Republican leaders urging passage of the bill, some Republicans voted no. Their party controls both chambers of Congress and the White House, but has struggled since taking power in January 2017 to approve budget legislation.

Republican Senator Rand Paul spent part of Thursday on social network Twitter criticizing what he said was unnecessary spending in the sprawling bill.

“Shame, shame. A pox on both Houses - and parties. Here’s the 2,232 page, $1.3 trillion, budget-busting Omnibus spending bill,” Paul declared in one message.

He decried a “monstrous bill” teeming with money for decades-old programs. His last-minute objections played a key role in delaying the Senate’s vote until the dead of night.

On Thursday, Representative Mark Meadows, who heads the far-right Freedom Caucus in the House of Representatives, said, “This omnibus doesn’t just forget the promises we made to voters - it flatly rejects them.”

He added, “This is not the limited government conservatism our voters demand.”

Not all of the opposition, however, was over fiscal policy.

Before he would let the voting proceed, Republican Senator James Risch insisted on a promise that a wilderness area in his home state of Idaho would not be named after the late former Governor Cecil Andrus, a Democrat.

The legislation has provisions that appeal to conservatives, however, with its $80-billion increase this year to the military budget and more border security funding.

But significantly higher non-defense spending put conservatives on edge. In the House, 90 of the chamber’s 238 Republicans revolted against the measure.

Coupled with recent tax cuts, the government funding bill is projected to lead to budget deficits of more than $800 billion for this year. Conservatives warned it could create problems for Republicans running for re-election in November.

SCALED-BACK TRUMP PROPOSALS

Several Trump initiatives would suffer setbacks. At one point during prolonged negotiations he pushed for $25 billion in funds to fully build his border wall with Mexico.

The president’s severe cuts to the Environmental Protection Agency, State Department and other federal agencies would also be scaled back.

White House budget director Mick Mulvaney told reporters the legislation “does a lot of what we wanted – not everything we wanted – but a lot of what we wanted on immigration.”

Trump said on Twitter the bill would allow him to start building the wall, which he calls an essential part of efforts to reduce illegal immigration. “Got $1.6 billion to start wall on southern border, rest will be forthcoming,” he wrote.

But Democrats, who have long opposed the wall, argued the added funds would help build or restore a range of other barriers, including existing fencing, but not a concrete edifice.

The $1.6 billion would also be used to hire more border patrol agents. But there would not be a significant increase in immigration agents, or in detention beds needed to step up immigrant deportations.

The Department of Homeland Security had sought a big boost in those officers’ ranks to boost deportations of illegal immigrants.

Besides the largest defense buildup in 15 years, the measure includes new funds to improve infrastructure and counter Russian election hacking.

In response to public anger and frustration over mass shootings, it includes modest improvements to background checks for gun sales and grants to help schools prevent gun violence.
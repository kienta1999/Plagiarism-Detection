WASHINGTON ― The Senate on Thursday confirmed Gina Haspel to be President Donald Trump’s CIA director after a number of Democrats facing tough reelection fights this year announced they would support her nomination.

Haspel, a former clandestine officer with more than 30 years of service at the agency, was confirmed by a narrow 54-45 vote. Sens. Joe Manchin (D-W.Va.), Joe Donnelly (D-Ind.), Mark Warner (D-Va.), Heidi Heitkamp (D-N.D.), Bill Nelson (D-Fla.) and Jeanne Shaheen (D-N.H.) joined nearly every Republican in voting to approve her nomination.

Haspel’s appointment to the CIA capped a contentious debate over the George W. Bush-era enhanced interrogation program ― which included torture techniques like waterboarding. The issue became relevant again after Trump pledged during his presidential campaign to revive torture.

Human rights advocates and even some Republicans, like Sens. John McCain (R-Arizona) and Sen. Rand Paul (R-Ky.), objected to Haspel because of her involvement in the torture program after the 9/11 attacks and her role in the subsequent destruction of videotapes that showed interrogations of certain suspects.

McCain’s opposition to Haspel, in particular, weighed heavily on the minds of his colleagues. The Arizona senator was tortured while in captivity during the Vietnam War and has long been an influential voice on the issue. Sen. Jeff Flake, the junior GOP senator from Arizona, also opposed Haspel because she had “not adequately answered” questions about her role in the destruction of interrogation tapes.

But McCain’s prolonged absence from the Senate ― he has been battling brain cancer in Sedona ― could be felt as well. It’s one thing to read a statement from McCain ― it’s entirely another thing to look into his eyes and tell him you intend to oppose him when it comes to the issue of torture.

Democrats had the power to block Haspel’s nomination. But a key moment heralding their defeat came when Warner, the top Democrat on the Senate intelligence committee, announced he would back her. The Virginia Democrat, whose state is home to CIA’s headquarters, cited Haspel’s written disavowal of the interrogation program as sufficient to gain his endorsement. His announcement gave several other moderate Democrats cover to back her as well.

In remarks on the Senate floor ahead of the vote, Warner said he wished Haspel had been more forceful in denouncing the program during her confirmation hearing. Ultimately, however, he said that private assurances from Haspel about her views on torture and her long list of bipartisan endorsements from the intelligence community had won him over.

“I will feel safer knowing the CIA has Ms. Haspel leading it,” Warner said Thursday. He added that he was confident that Haspel would stand up and refuse an order from Trump if he tells her “to do something illegal or immoral, like torture.”
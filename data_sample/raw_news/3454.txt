WASHINGTON – President Donald Trump on Friday signed a government spending bill that fails to fund his long-promised border wall, notwithstanding a threat just hours earlier to veto the legislation.

“As a matter of national security I’ve signed this omnibus budget bill. There are a lot of things I’m unhappy about in this bill,” the president said in a rambling, 20-minute explanation of why he approved the spending plan despite his misgivings. “I say to Congress: I will never sign another bill like this again.”

Trump’s explanation, though, may not be enough to mollify his base of supporters, many of whom expected Trump to follow through on his often-repeated promise of a border wall.

“This will crush the spirit of ‘the deplorables,’ as this is exactly what they voted against,” said one Republican adviser close to Trump who spoke on the condition of anonymity.

Earlier Friday, Trump said he was considering a veto because of the lack of wall money, as well as the failure to fix the DACA immigration program ― even though his own White House last month sabotaged legislation accomplishing precisely those two items.

The veto threat of the $1.3 trillion spending bill came after fierce lobbying from a group of conservative House members, which included a pointed accusation that House Speaker Paul Ryan (R-Wis.) had lied to Trump about how much money was included for his wall along the Mexican border, according to the Republican adviser.

Key members of the House Freedom Caucus, including Rep. Mark Meadows (R-N.C.), began urging Trump to veto the bill almost immediately after Ryan returned from a White House visit on Wednesday to win Trump’s support for the spending plan, the Republican adviser said.

That plan wound up clearing both chambers Thursday. Had Trump failed to sign the measure, the government would have run out of spending authority and partially shut down at midnight Friday.

Meadows declined to comment.

Freedom Caucus members explained to Trump that the spending plan does not actually allocate money to start construction of a modern wall along any stretch of the border that does not already have some form of barrier, the adviser said. Rather, it includes $641 million to build levees and fencing for 33 miles that currently lack a barrier.

What doubts that Freedom Caucus members planted in Trump’s mind, the adviser said, Fox News nurtured to fuition, with highly critical Thursday night programming about the spending deal.

“There’s a 50-50 shot he vetoes this,” the adviser predicted earlier Friday.

President Donald Trump inspects border wall prototypes in San Diego, California, on March 13, 2018. MANDEL NGAN via Getty Images

Trump’s veto threat came in a Twitter statement issued at 8:55 a.m. “I am considering a VETO of the Omnibus Spending Bill based on the fact that the 800,000 plus DACA recipients have been totally abandoned by the Democrats (not even mentioned in Bill) and the BORDER WALL, which is desperately needed for our National Defense, is not fully funded,” he wrote.

Yet those demands would have been met in a bipartisan proposal that received 54 votes on the Senate floor last month – six short of the threshold needed to proceed. That came after a furious lobbying effort against the proposal by Trump’s White House, including an extraordinary conference call in which a senior administration official attacked South Carolina Republican Sen. Lindsey Graham by name.

“He has been an obstacle to immigration reform. He has been an obstacle in the way of getting relief for Dreamers,” said the official, who spoke on the condition he not be identified.

Trump’s Department of Homeland Security put out a similarly strident statement opposing the plan: “The changes proposed by Senators Schumer-Rounds-Collins would effectively make the United States a Sanctuary Nation where ignoring the rule of law is encouraged.”

“Dreamers” is the colloquial term for undocumented immigrants who were brought into this country as children. About 700,000 received work permits and formal reprieves from deportation under the Deferred Action for Childhood Arrivals program during former President Barack Obama’s administration. Trump rescinded the program in September.

Under the proposal sponsored by senators, including Republicans Mike Rounds of South Dakota and Susan Collins of Maine, as well as Democratic Leader Chuck Schumer of New York, the DACA-eligible population would have been allowed to stay permanently and be given a lengthy path toward eventual citizenship. In exchange, Trump would have been given the authorization to build his wall in full.

The White House instead pushed its own plan, which included the DACA fix and wall funding, but also limits on legal immigration and asylum seekers. That proposal received only 39 votes in the Senate – the fewest of any of the competing plans voted on that day.

Ali Noorani, executive director of the pro-reform group National Immigration Forum, said he believes the Rounds-King bill would have succeeded with 60 votes had the White House not come out against it.

“There is a deal that includes the protection of Dreamers and the protection of our border if the president is serious,” Noorani said. “Up to this point, he’s missed every opportunity to take that deal.”

Democratic lawmakers offered Trump that same swap in recent days: $25 billion for his border wall in exchange for a path to citizenship for 1.8 million DACA-eligible undocumented immigrants.

“The White House proposal gave them everything they asked for while leaving Dreamers in limbo,” a senior Democratic aide said. “Our counteroffer lined up perfectly with what the president had proposed, but of course, he said no to his own deal. Again.”

Trump’s Friday morning veto threat came less than 24 hours after top White House officials said definitively that Trump would sign the spending plan when it reached his desk. “Let’s cut right to the chase: Is the president to sign the bill? The answer is yes,” budget director Mick Mulvaney said Thursday.

And those assurances of Trump approval came the day after Ryan trekked through a snowstorm to explain to Trump why he should sign the spending bill. The meeting took place in the White House residence and included Vice President Mike Pence. Ryan told Trump this was the best deal he was likely to get, and emphasized the large increase in military spending that Trump had sought and could claim as a victory, according to an official familiar with the meeting.

Ryan apparently succeeded in his sales pitch. Trump signaled support for the plan in a Twitter statement at 11 p.m. that night: “Got $1.6 Billion to start Wall on Southern Border, rest will be forthcoming. Most importantly, got $700 Billion to rebuild our Military, $716 Billion next year...most ever. Had to waste money on Dem giveaways in order to take care of military pay increase and new equipment.”

In the end it was the increase in military spending that Trump cited Friday, too. “My highest duty is to keep America safe. Nothing more important,” he said, adding that he had “very seriously” considered vetoing the measure.

Trump has spoken about his “great wall” on the Mexican border since his campaign announcement speech at Trump Tower in June 2015. For the 17 months of his campaign, Trump promised many hundreds of times that he would build a 30-foot-tall wall to keep out illegal immigrants.

Trump also promised that the wall would be built at no cost to U.S. taxpayers, and that he would force Mexico to foot the bill. “Mark my words,” he said during his announcement speech.

That promise, however, has proven elusive. A planned meeting between Trump and Mexican President Enrique Peña Nieto was recently canceled because Peña Nieto would not back away from his refusal to pay.

Matt Fuller contributed reporting.